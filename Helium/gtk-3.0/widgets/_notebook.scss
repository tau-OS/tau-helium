// *************
// * Notebooks *
// *************

@use 'shared' as *;
@use 'base' as *;
@use 'button' as *;
notebook {
  @include focus-ring(
    "> header > tabs > tab:checked",
    $offset: -2px,
    $focus-state: ':focus'
  );

  > header {
    padding: 1px;
    background: bg-color(-3);
    background-clip: padding-box;
    box-shadow: none;

    > tabs { margin: -1px; }

    &.top {
      border-bottom-style: solid;
      > tabs {
        margin-bottom: -2px;
        > tab {
          &:hover { box-shadow: inset 0 -4px $borders_color; }

          &:checked { box-shadow: inset 0 -4px $accent_bg_color; }
        }
      }
    }

    &.bottom {
      border-top-style: solid;
      > tabs {
        margin-top: -2px;
        > tab {
          &:hover { box-shadow: inset 0 4px $borders_color; }

          &:checked { box-shadow: inset 0 4px $accent_bg_color; }
        }
      }
    }

    &.left {
      border-right-style: solid;
      > tabs {
        margin-right: -2px;
        > tab {
          &:hover { box-shadow: inset -4px 0 $borders_color; }

          &:checked { box-shadow: inset -4px 0 $accent_bg_color; }
        }
      }
    }

    &.right {
      border-left-style: solid;
      > tabs {
        margin-left: -2px;
        > tab {
          &:hover { box-shadow: inset 4px 0 $borders_color; }

          &:checked { box-shadow: inset 4px 0 $accent_bg_color; }
        }
      }
    }

    &.top > tabs > arrow {
      @extend %notebook_vert_arrows;

      border-top-style: none;
    }

    &.bottom > tabs > arrow {
      @extend %notebook_vert_arrows;

      border-bottom-style: none;
    }

    @at-root %notebook_vert_arrows {
      margin-left: -5px;
      margin-right: -5px;
      padding-left: 4px;
      padding-right: 4px;

      &.down { -gtk-icon-source: -gtk-icontheme('pan-start-symbolic'); }

      &.up { -gtk-icon-source: -gtk-icontheme('pan-end-symbolic'); }
    }

    &.left > tabs > arrow {
      @extend %notebook_horz_arrows;

      border-left-style: none;
    }

    &.right > tabs > arrow {
      @extend %notebook_horz_arrows;

      border-right-style: none;
    }

    @at-root %notebook_horz_arrows {
      margin-top: -5px;
      margin-bottom: -5px;
      padding-top: 4px;
      padding-bottom: 4px;

      &.down { -gtk-icon-source: -gtk-icontheme('pan-up-symbolic'); }

      &.up { -gtk-icon-source: -gtk-icontheme('pan-down-symbolic'); }
    }

    > tabs > arrow {
      @extend %button_basic;
      @extend %button_basic_flat;

      min-height: 16px;
      min-width: 16px;
      border-radius: 0;

      &:hover:not(:active) {
        background: none;
        box-shadow: none;
      }
    }

    > tabs > tab {
      transition: $focus_transition;
      min-height: 30px;
      min-width: 30px;
      padding: 3px 12px;
      border: 1px solid transparent;
      border-radius: $button_radius;
      color: $view_fg_color;
      background: transparent;
      outline-color: transparent;

      &:hover { background: state-color(bg-color(-3), $surface_fg_color, 1); }

      &:checked {
        color: $view_fg_color;
        background: state-color(bg-color(-3), $surface_fg_color, 2);
      }

      &:active { background: state-color(bg-color(-3), $surface_fg_color, 2); }

      &:backdrop {
        color: gtkmix($view_fg_color, $view_bg_color, 70%);
        background: state-color(bg-color(-3), $surface_fg_color, 0);
        box-shadow: none;
      }

      &:disabled {
        background: gtkalpha($view_fg_color, 0.12);
        color: gtkalpha($view_fg_color, 0.38);
        box-shadow: none;
      }

      &.reorderable-page {
        border: none;
        border-radius: 0;
        background: state-color(bg-color(-3), $surface_fg_color, 0);

        &:hover { background: state-color(bg-color(-3), $surface_fg_color, 1); }

        &:checked { background: state-color(bg-color(-3), $surface_fg_color, 2); }
      }

      &:backdrop.reorderable-page {
        color: gtkmix($backdrop_fg_color, $backdrop_bg_color, 60%);
        background: state-color(bg-color(-3), $surface_fg_color, 0);
      }

      &:backdrop.reorderable-page:checked {
        background: state-color(bg-color(-3), $surface_fg_color, 1);
      }

      button.flat {
        color: gtkalpha(currentColor, 0.3);
        &:hover { color: currentColor; }

        padding: 0;
        margin-top: 4px;
        margin-bottom: 4px;
        min-width: 20px;
        min-height: 20px;

        &:last-child {
          margin-left: 4px;
          margin-right: -4px;
        }

        &:first-child {
          margin-left: -4px;
          margin-right: 4px;
        }
      }
    }

    &.top,
    &.bottom {
      > tabs {
        padding-left: 4px;
        padding-right: 4px;

        &:not(:only-child) {
          margin-left: 3px;
          margin-right: 3px;

          &:first-child { margin-left: -1px; }
          &:last-child { margin-right: -1px; }
        }

        > tab {
          margin-left: 4px;
          margin-right: 4px;

          &.reorderable-page {
            border-style: none solid;
            margin-left: 0;
            margin-right: 0;
          }
        }
      }
    }

    &.left,
    &.right {
      > tabs {
        padding-top: 4px;
        padding-bottom: 4px;

        &:not(:only-child) {
          margin-top: 3px;
          margin-bottom: 3px;

          &:first-child { margin-top: -1px; }
          &:last-child { margin-bottom: -1px; }
        }

        > tab {
          margin-top: 4px;
          margin-bottom: 4px;

          &.reorderable-page {
            border-style: none solid;
            margin-top: 0;
            margin-bottom: 0;
          }
        }
      }
    }

    &.top > tabs > tab { padding-bottom: 4px; }
    &.bottom > tabs > tab { padding-top: 4px; }
  }

  > stack:not(:only-child) {
    background: $view_bg_color;
  }

  .osd & {
    > header {
      background: gtkalpha($osd_fill_bg_color, 0.85);
      border-color: gtkalpha($osd_border_base_color, 0.2);

      > tabs > tab {
        color: $osd_fill_fg_color;
        background: transparent;

        &:hover { background: gtkalpha($osd_fill_fg_color, 0.12); }

        &:checked { background: gtkalpha($osd_fill_fg_color, 0.18); }

        &:disabled {
          background: $osd_insensitive_bg_color;
          color: $osd_insensitive_fg_color;
        }
      }
    }
  }
}